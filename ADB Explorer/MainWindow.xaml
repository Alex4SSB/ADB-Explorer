<Window
    x:Class="ADB_Explorer.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:ADB_Explorer.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:sys="clr-namespace:System;assembly=System.Runtime"
    xmlns:ui="http://schemas.modernwpf.com/2019"
    x:Name="MainWin"
    Title="ADB Explorer"
    Width="800"
    Height="450"
    MinWidth="530"
    MinHeight="400"
    ui:ThemeManager.IsThemeAware="True"
    ui:WindowHelper.UseModernWindowStyle="True"
    Background="{DynamicResource SystemControlPageBackgroundChromeMediumLowBrush}"
    Closing="Window_Closing"
    KeyDown="Window_KeyDown"
    MouseDown="Window_MouseDown"
    MouseUp="Window_MouseUp"
    SizeChanged="Window_SizeChanged"
    SourceInitialized="Window_SourceInitialized"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">
    <Window.Resources>
        <sys:Int16 x:Key="FontSize">13</sys:Int16>
        <converters:VisibilityToStateConverter x:Key="VisibilityToStateConverter" />
        <MenuItem
            x:Key="ContextMenuCopyItem"
            Click="ContextMenuCopyItem_Click"
            Resources="{StaticResource ContextSubMenuStyles}">
            <MenuItem.Header>
                <StackPanel>
                    <Grid Margin="-3,0,-4,0">
                        <ui:FontIcon HorizontalAlignment="Left" Glyph="&#xE8EA;" />
                        <ui:FontIcon
                            Margin="11,0,0,0"
                            FontSize="12"
                            Glyph="&#xE974;" />
                    </Grid>
                    <TextBlock Text="Pull" />
                </StackPanel>
            </MenuItem.Header>
        </MenuItem>
        <MenuItem x:Key="ContextMenuDeleteItem" Resources="{StaticResource ContextSubMenuStyles}">
            <MenuItem.Header>
                <StackPanel>
                    <ui:FontIcon Glyph="&#xE74D;" />
                    <TextBlock Text="Delete" />
                </StackPanel>
            </MenuItem.Header>
        </MenuItem>
        <MenuItem
            x:Key="PathMenuHeader"
            Margin="0,0,0,-5"
            HorizontalAlignment="Center"
            Click="PathMenuEdit_Click"
            IsEnabled="False">
            <MenuItem.Header>
                <TextBlock HorizontalAlignment="Center" Text="Path" />
            </MenuItem.Header>
        </MenuItem>
        <MenuItem
            x:Key="PathMenuEdit"
            Click="PathMenuEdit_Click"
            Resources="{StaticResource ContextSubMenuStyles}">
            <MenuItem.Header>
                <StackPanel>
                    <ui:FontIcon Glyph="&#xE70F;" />
                    <TextBlock Text="Edit" />
                </StackPanel>
            </MenuItem.Header>
        </MenuItem>
        <MenuItem
            x:Key="PathMenuCopy"
            Click="PathMenuCopy_Click"
            Resources="{StaticResource ContextSubMenuStyles}">
            <MenuItem.Header>
                <StackPanel>
                    <ui:FontIcon Glyph="&#xE8C8;" />
                    <TextBlock Text="Copy" />
                </StackPanel>
            </MenuItem.Header>
        </MenuItem>
        <Menu x:Key="FileOpStopMenu" x:Shared="False">
            <Menu.Style>
                <Style BasedOn="{StaticResource MenuStyle}" TargetType="Menu">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding ElementName=CurrentOperationDetailedDataGrid, Path=Items.Count}" Value="0">
                            <Setter Property="IsEnabled" Value="False" />
                        </DataTrigger>
                    </Style.Triggers>
                    <Setter Property="IsEnabled" Value="True" />
                </Style>
            </Menu.Style>
            <MenuItem Click="StopFileOperations_Click" ToolTip="Stop">
                <MenuItem.Header>
                    <ui:FontIcon Glyph="&#xE71A;" />
                </MenuItem.Header>
            </MenuItem>
        </Menu>
        <Menu
            x:Key="FileOpRemoveMenu"
            x:Shared="False"
            FlowDirection="LeftToRight">
            <Menu.Style>
                <Style BasedOn="{StaticResource MenuStyle}" TargetType="Menu">
                    <Style.Triggers>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding ElementName=PendingOperationsDetailedDataGrid, Path=Items.Count}" Value="0" />
                                <Condition Binding="{Binding ElementName=CompletedOperationsDetailedDataGrid, Path=Items.Count}" Value="0" />
                            </MultiDataTrigger.Conditions>
                            <Setter Property="IsEnabled" Value="False" />
                        </MultiDataTrigger>
                    </Style.Triggers>
                    <Setter Property="IsEnabled" Value="True" />
                </Style>
            </Menu.Style>
            <MenuItem ToolTip="Remove Operations">
                <MenuItem.Header>
                    <ui:FontIcon Glyph="&#xE711;" />
                </MenuItem.Header>
                <MenuItem Click="RemovePending_Click">
                    <MenuItem.Header>
                        <StackPanel Orientation="Horizontal">
                            <ui:FontIcon
                                Margin="0,0,4,0"
                                FontSize="16"
                                Glyph="&#xECC5;" />
                            <TextBlock Text="Pending" />
                        </StackPanel>
                    </MenuItem.Header>
                </MenuItem>
                <MenuItem Click="RemoveCompleted_Click">
                    <MenuItem.Header>
                        <StackPanel Orientation="Horizontal">
                            <ui:FontIcon
                                Margin="0,0,4,0"
                                FontSize="16"
                                Glyph="&#xE930;" />
                            <TextBlock Text="Completed" />
                        </StackPanel>
                    </MenuItem.Header>
                </MenuItem>
                <MenuItem Click="RemovePendingAndCompleted_Click">
                    <MenuItem.Header>
                        <StackPanel Orientation="Horizontal">
                            <ui:FontIcon
                                Margin="0,0,4,0"
                                FontSize="16"
                                Glyph="&#xECC9;" />
                            <TextBlock Text="All" />
                        </StackPanel>
                    </MenuItem.Header>
                </MenuItem>
            </MenuItem>
        </Menu>
        <Menu x:Key="FileOpDefaultFolderMenu" x:Shared="False">
            <Menu.Style>
                <Style BasedOn="{StaticResource MenuStyle}" TargetType="Menu">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding ElementName=DefaultFolderBlock, Path=Text}" Value="[not set]">
                            <Setter Property="IsEnabled" Value="False" />
                        </DataTrigger>
                    </Style.Triggers>
                    <Setter Property="IsEnabled" Value="True" />
                </Style>
            </Menu.Style>
            <MenuItem Click="OpenDefaultFolder_Click" ToolTip="Open Default Folder">
                <MenuItem.Header>
                    <ui:FontIcon Glyph="&#xED25;" />
                </MenuItem.Header>
            </MenuItem>
        </Menu>
        <ui:Flyout x:Key="PairServiceFlyout">
            <StackPanel>
                <TextBlock Text="On phone: Switch Wireless debugging off then on" />
                <TextBlock Margin="0,8" Text="Click the button below to switch to device discovery" />
                <Grid>
                    <ui:FontIcon
                        Margin="6"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Bottom"
                        Glyph="&#xE946;"
                        Style="{StaticResource GlyphFont}" />
                    <Button
                        x:Name="PairFlyoutCloseButton"
                        Margin="0,10,4,0"
                        HorizontalAlignment="Right"
                        Click="PairFlyoutCloseButton_Click"
                        Content="Close"
                        Style="{StaticResource ButtonStyle}" />
                </Grid>
            </StackPanel>
        </ui:Flyout>
        <DataTemplate x:Key="DriveItemTemplate" DataType="Drive">
            <ui:ListViewItem MouseDoubleClick="DriveItem_MouseDoubleClick">
                <Grid MinWidth="256">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <ui:FontIcon
                        Margin="0,0,8,0"
                        FontSize="32"
                        Glyph="{Binding DriveIcon}">
                        <ui:FontIcon.Style>
                            <Style BasedOn="{StaticResource GlyphFont}" TargetType="ui:FontIcon">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Type}" Value="Unknown">
                                        <Setter Property="Visibility" Value="Hidden" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ui:FontIcon.Style>
                    </ui:FontIcon>
                    <StackPanel Grid.Column="1">
                        <StackPanel Orientation="Horizontal">
                            <StackPanel.Resources>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontWeight" Value="SemiBold" />
                                </Style>
                            </StackPanel.Resources>
                            <TextBlock Text="{Binding PrettyName}" />
                            <StackPanel Orientation="Horizontal">
                                <StackPanel.Style>
                                    <Style TargetType="StackPanel">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Type}" Value="External">
                                                <Setter Property="Visibility" Value="Visible" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Type}" Value="Emulated">
                                                <Setter Property="Visibility" Value="Visible" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </StackPanel.Style>
                                <TextBlock Text=" (" />
                                <TextBlock
                                    VerticalAlignment="Center"
                                    FontFamily="Consolas"
                                    Text="{Binding ID}" />
                                <TextBlock Text=")" />
                            </StackPanel>
                        </StackPanel>
                        <StackPanel>
                            <StackPanel.Style>
                                <Style TargetType="StackPanel">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding UsageP}" Value="-1">
                                            <Setter Property="Visibility" Value="Hidden" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </StackPanel.Style>
                            <ui:ProgressBar Margin="0,6" Value="{Binding UsageP, Mode=OneWay}" />
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="{Binding Available, Mode=OneWay}" />
                                <TextBlock Text=" free of " />
                                <TextBlock Text="{Binding Size, Mode=OneWay}" />
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </ui:ListViewItem>
        </DataTemplate>
        <HierarchicalDataTemplate
            x:Key="FileOpSettingsTreeTemplate"
            DataType="ColumnConfig"
            ItemsSource="{Binding Items}">
            <Grid Width="200">
                <Grid>
                    <Grid.Style>
                        <Style TargetType="Grid">
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Title}" Value="{x:Null}">
                                    <Setter Property="Visibility" Value="Visible" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Grid.Style>
                    <ComboBox
                        HorizontalAlignment="Stretch"
                        ItemsSource="{Binding ColumnList}"
                        SelectedItem="{Binding Selected}" />
                </Grid>
                <Grid>
                    <Grid.Style>
                        <Style TargetType="Grid">
                            <Setter Property="Visibility" Value="Visible" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Title}" Value="{x:Null}">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Grid.Style>
                    <TextBlock
                        VerticalAlignment="Center"
                        FontWeight="Bold"
                        Text="{Binding Title}" />
                </Grid>
            </Grid>
        </HierarchicalDataTemplate>
        <Style
            x:Key="DataGridCellStyle"
            BasedOn="{StaticResource BaseCellStyle}"
            TargetType="{x:Type DataGridCell}">
            <EventSetter Event="RequestBringIntoView" Handler="DataGridCell_RequestBringIntoView" />
        </Style>
        <Style
            x:Key="RowStyle"
            BasedOn="{StaticResource BaseRowStyle}"
            TargetType="DataGridRow">
            <EventSetter Event="MouseDown" Handler="DataGridRow_MouseDown" />
            <EventSetter Event="MouseDoubleClick" Handler="DataGridRow_MouseDoubleClick" />
            <EventSetter Event="KeyDown" Handler="DataGridRow_KeyDown" />
        </Style>
        <Style
            x:Key="DeviceStyle"
            BasedOn="{StaticResource BaseDeviceStyle}"
            TargetType="ui:ListViewItem">
            <EventSetter Event="PreviewMouseDown" Handler="ListViewItem_MouseDown" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ui:ListViewItem">
                        <Border Background="{TemplateBinding Background}" Style="{StaticResource DeviceBorderStyle}">
                            <Grid Margin="6">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition Height="{Binding ElementName=DeviceExpandRect, Path=ActualHeight}" />
                                </Grid.RowDefinitions>
                                <StackPanel x:Name="DeviceDetailsPanel" Orientation="Horizontal">
                                    <Grid>
                                        <Grid.Resources>
                                            <Style BasedOn="{StaticResource DeviceStatusFontSizeStyle}" TargetType="ui:FontIcon" />
                                        </Grid.Resources>
                                        <ui:FontIcon Glyph="{Binding TypeIcon}" />
                                        <Grid>
                                            <Grid.Style>
                                                <Style TargetType="Grid">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Device.Status}" Value="Online">
                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Grid.Style>
                                            <ui:FontIcon Style="{StaticResource DeviceStatusIconStyle}" />
                                            <ui:FontIcon Foreground="{TemplateBinding Background}" Glyph="{Binding StatusIcon}" />
                                        </Grid>
                                    </Grid>
                                    <TextBlock
                                        Margin="4"
                                        VerticalAlignment="Center"
                                        Style="{StaticResource DeviceNameTextBlockStyle}" />
                                </StackPanel>
                                <ui:FontIcon
                                    Margin="4"
                                    HorizontalAlignment="Right"
                                    Foreground="Gray"
                                    Glyph="&#xE838;">
                                    <ui:FontIcon.Style>
                                        <Style BasedOn="{StaticResource GlyphFont}" TargetType="ui:FontIcon">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsOpen}" Value="True">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                            <Setter Property="Visibility" Value="Collapsed" />
                                        </Style>
                                    </ui:FontIcon.Style>
                                </ui:FontIcon>
                                <Rectangle
                                    x:Name="DeviceExpandRect"
                                    Grid.Row="1"
                                    Height="{Binding ElementName=DeviceExpandPanel, Path=ActualHeight}"
                                    Fill="Transparent">
                                    <Rectangle.Style>
                                        <Style TargetType="Rectangle">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation
                                                                    Storyboard.TargetProperty="Height"
                                                                    From="0"
                                                                    Duration="0:00:00.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                    <DataTrigger.ExitActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation
                                                                    Storyboard.TargetProperty="Height"
                                                                    To="0"
                                                                    Duration="0:00:00.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.ExitActions>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Rectangle.Style>
                                </Rectangle>
                                <StackPanel
                                    x:Name="DeviceExpandPanel"
                                    Grid.Row="1"
                                    VerticalAlignment="Bottom">
                                    <StackPanel.Style>
                                        <Style TargetType="StackPanel">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsSelected}" Value="False">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                            <Setter Property="Visibility" Value="Visible" />
                                        </Style>
                                    </StackPanel.Style>
                                    <Grid Margin="0,6,0,0">
                                        <Grid.Style>
                                            <Style TargetType="Grid">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsMdns}" Value="True">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                                <Setter Property="Visibility" Value="Collapsed" />
                                            </Style>
                                        </Grid.Style>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <TextBox
                                            ui:ControlHelper.PlaceholderText="Pairing Code"
                                            ui:TextBoxHelper.IsDeleteButtonVisible="False"
                                            KeyDown="PairingCodeTextBox_KeyDown"
                                            Style="{StaticResource PairingTextBoxStyle}"
                                            Text="{Binding UIPairingCode, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            TextChanged="PairingCodeTextBox_TextChanged" />
                                        <Button
                                            Grid.Column="1"
                                            Margin="6,0,0,0"
                                            ui:FlyoutService.Flyout="{StaticResource PairServiceFlyout}"
                                            Click="PairServiceButton_Click"
                                            Content="Pair">
                                            <Button.Style>
                                                <Style BasedOn="{StaticResource ButtonStyle}" TargetType="Button">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding UIPairingCode.Length}" Value="11">
                                                            <Setter Property="IsEnabled" Value="True" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                    <Setter Property="IsEnabled" Value="False" />
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                    </Grid>
                                    <StackPanel
                                        Margin="0,6,0,0"
                                        HorizontalAlignment="Right"
                                        Orientation="Horizontal">
                                        <Button
                                            x:Name="OpenDeviceButton"
                                            Margin="8,0"
                                            Click="OpenDeviceButton_Click"
                                            Content="Browse"
                                            Style="{StaticResource DeviceBrowseButtonStyle}" />
                                        <Button
                                            x:Name="DisconnectDeviceButton"
                                            Click="DisconnectDeviceButton_Click"
                                            Style="{StaticResource DeviceRemoveButtonStyle}">
                                            <StackPanel Orientation="Horizontal">
                                                <ui:FontIcon
                                                    Margin="-4,1,4,-2"
                                                    VerticalAlignment="Center"
                                                    Glyph="&#xECC9;"
                                                    Style="{DynamicResource DisabledButtonGlyphStyle}" />
                                                <Grid>
                                                    <TextBlock Text="Remove" Visibility="Hidden" />
                                                    <TextBlock Style="{StaticResource RemoveDeviceButtonStyle}" />
                                                </Grid>
                                            </StackPanel>
                                        </Button>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <Window.TaskbarItemInfo>
        <TaskbarItemInfo
            x:Name="TaskBarInfo"
            ProgressState="{Binding ElementName=UpperProgressBar, Path=Visibility, Converter={StaticResource VisibilityToStateConverter}}"
            ProgressValue="{Binding ElementName=UpperProgressBar, Path=Value}" />
    </Window.TaskbarItemInfo>
    <Grid>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Menu Margin="7,4" VerticalAlignment="Center">
                    <Menu.Resources>
                        <Style BasedOn="{StaticResource DisabledGlyphStyle}" TargetType="ui:FontIcon">
                            <Setter Property="FontSize" Value="18" />
                        </Style>
                        <Style BasedOn="{StaticResource DisabledTextBlockStyle}" TargetType="TextBlock" />
                    </Menu.Resources>
                    <MenuItem
                        x:Name="OpenDevicesButton"
                        Click="OpenDevicesButton_Click"
                        ToolTip="Devices">
                        <MenuItem.Header>
                            <Grid>
                                <ui:FontIcon Glyph="&#xE8CC;" />
                                <TextBlock
                                    Margin="0,0,-10,-12"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom"
                                    Text="{Binding ElementName=DevicesList, Path=Items.Count}" />
                            </Grid>
                        </MenuItem.Header>
                    </MenuItem>
                    <Separator Margin="4,0" Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
                    <MenuItem
                        x:Name="PullMenuButton"
                        Click="PullMenuButton_Click"
                        IsEnabled="False"
                        ToolTip="Pull">
                        <MenuItem.Header>
                            <Grid Margin="-4,0,-6,0">
                                <ui:FontIcon HorizontalAlignment="Left" Glyph="&#xE8EA;" />
                                <ui:FontIcon
                                    Margin="14,0,0,0"
                                    FontSize="14"
                                    Glyph="&#xE974;" />
                            </Grid>
                        </MenuItem.Header>
                    </MenuItem>
                    <MenuItem
                        x:Name="PushMenuButton"
                        IsEnabled="False"
                        ToolTip="Push">
                        <MenuItem.Header>
                            <Grid Margin="-4,0,-6,0">
                                <ui:FontIcon HorizontalAlignment="Left" Glyph="&#xE8EA;" />
                                <ui:FontIcon
                                    Margin="14,0,0,0"
                                    FontSize="14"
                                    Glyph="&#xE973;" />
                            </Grid>
                        </MenuItem.Header>
                        <MenuItem x:Name="PasteFilesMenu" Click="PushMenuButton_Click">
                            <MenuItem.Header>
                                <StackPanel Margin="0,2,0,0" Orientation="Horizontal">
                                    <ui:FontIcon
                                        Margin="0,0,8,0"
                                        FontSize="20"
                                        Glyph="&#xE8A5;"
                                        Style="{StaticResource DisabledGlyphStyle}" />
                                    <TextBlock VerticalAlignment="Center" Text="Files" />
                                </StackPanel>
                            </MenuItem.Header>
                        </MenuItem>
                        <MenuItem x:Name="PasteFoldersMenu" Click="PushMenuButton_Click">
                            <MenuItem.Header>
                                <StackPanel Margin="0,2,0,0" Orientation="Horizontal">
                                    <ui:FontIcon
                                        Margin="0,0,8,0"
                                        FontSize="20"
                                        Glyph="&#xE8B7;"
                                        Style="{StaticResource DisabledGlyphStyle}" />
                                    <TextBlock VerticalAlignment="Center" Text="Folders" />
                                </StackPanel>
                            </MenuItem.Header>
                        </MenuItem>
                    </MenuItem>
                    <Separator Margin="4,0" Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
                    <MenuItem
                        x:Name="NewMenuButton"
                        Margin="2,0"
                        IsEnabled="False">
                        <MenuItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <ui:FontIcon
                                    Margin="0,0,8,0"
                                    FontSize="20"
                                    Glyph="&#xECC8;"
                                    Style="{StaticResource DisabledGlyphStyle}" />
                                <TextBlock VerticalAlignment="Center" Text="New" />
                            </StackPanel>
                        </MenuItem.Header>
                        <MenuItem>
                            <MenuItem.Header>
                                <StackPanel Orientation="Horizontal">
                                    <ui:FontIcon
                                        Margin="0,0,8,0"
                                        FontSize="16"
                                        Glyph="&#xECC8;" />
                                    <TextBlock Text="New Item" />
                                </StackPanel>
                            </MenuItem.Header>
                        </MenuItem>
                        <MenuItem>
                            <MenuItem.Header>
                                New Folder
                            </MenuItem.Header>
                        </MenuItem>
                    </MenuItem>
                    <MenuItem IsEnabled="False" ToolTip="Cut">
                        <MenuItem.Header>
                            <ui:FontIcon Glyph="&#xE8C6;" />
                        </MenuItem.Header>
                    </MenuItem>
                    <MenuItem
                        x:Name="CopyMenuButton"
                        Click="CopyMenuButton_Click"
                        IsEnabled="False"
                        ToolTip="Copy">
                        <MenuItem.Header>
                            <ui:FontIcon Glyph="&#xE8C8;" />
                        </MenuItem.Header>
                    </MenuItem>
                    <MenuItem
                        x:Name="PasteMenuButton"
                        IsEnabled="False"
                        ToolTip="Paste">
                        <MenuItem.Header>
                            <ui:FontIcon Glyph="&#xE77F;" />
                        </MenuItem.Header>
                    </MenuItem>
                    <MenuItem IsEnabled="False" ToolTip="Rename">
                        <MenuItem.Header>
                            <ui:FontIcon Glyph="&#xE8AC;" />
                        </MenuItem.Header>
                    </MenuItem>
                    <MenuItem IsEnabled="False" ToolTip="Delete">
                        <MenuItem.Header>
                            <ui:FontIcon Glyph="&#xE74D;" />
                        </MenuItem.Header>
                    </MenuItem>
                </Menu>
                <Border Grid.Column="1" MouseDown="Window_MouseDown" />
            </Grid>
            <StackPanel
                Margin="0,0,7,0"
                HorizontalAlignment="Right"
                Orientation="Horizontal">
                <StackPanel.Resources>
                    <Style
                        x:Key="RightMenuGlyph"
                        BasedOn="{StaticResource DisabledGlyphStyle}"
                        TargetType="ui:FontIcon">
                        <Setter Property="FontSize" Value="18" />
                    </Style>
                </StackPanel.Resources>
                <StackPanel VerticalAlignment="Center">
                    <Menu>
                        <MenuItem
                            x:Name="FileOperationsButton"
                            Click="FileOperationsButton_Click"
                            ToolTip="File Operations">
                            <MenuItem.Header>
                                <Grid>
                                    <ui:FontIcon Glyph="&#xF16A;">
                                        <ui:FontIcon.Style>
                                            <Style BasedOn="{StaticResource RightMenuGlyph}" TargetType="ui:FontIcon">
                                                <Style.Triggers>
                                                    <MultiDataTrigger>
                                                        <MultiDataTrigger.Conditions>
                                                            <Condition Binding="{Binding ElementName=CurrentOperationDataGrid, Path=Items.Count}" Value="1" />
                                                            <Condition Binding="{Binding ElementName=UpperProgressBar, Path=IsIndeterminate}" Value="False" />
                                                        </MultiDataTrigger.Conditions>
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                    </MultiDataTrigger>
                                                </Style.Triggers>
                                                <Setter Property="Visibility" Value="Visible" />
                                            </Style>
                                        </ui:FontIcon.Style>
                                    </ui:FontIcon>
                                    <ui:ProgressRing IsActive="True">
                                        <ui:ProgressRing.Style>
                                            <Style TargetType="ui:ProgressRing">
                                                <Style.Triggers>
                                                    <MultiDataTrigger>
                                                        <MultiDataTrigger.Conditions>
                                                            <Condition Binding="{Binding ElementName=CurrentOperationDataGrid, Path=Items.Count}" Value="1" />
                                                            <Condition Binding="{Binding ElementName=UpperProgressBar, Path=IsIndeterminate}" Value="False" />
                                                        </MultiDataTrigger.Conditions>
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </MultiDataTrigger>
                                                </Style.Triggers>
                                                <Setter Property="Visibility" Value="Collapsed" />
                                            </Style>
                                        </ui:ProgressRing.Style>
                                    </ui:ProgressRing>
                                </Grid>
                            </MenuItem.Header>
                        </MenuItem>
                    </Menu>
                </StackPanel>
                <Menu>
                    <MenuItem
                        x:Name="SettingsButton"
                        Click="SettingsButton_Click"
                        ToolTip="Settings">
                        <MenuItem.Header>
                            <ui:FontIcon Glyph="&#xE713;" Style="{DynamicResource RightMenuGlyph}" />
                        </MenuItem.Header>
                    </MenuItem>
                </Menu>
            </StackPanel>
            <Grid Grid.Row="1">
                <StackPanel Margin="0,4,0,2">
                    <Separator />
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Menu Margin="7,0,0,0">
                            <Menu.Resources>
                                <Style BasedOn="{StaticResource DisabledGlyphStyle}" TargetType="ui:FontIcon">
                                    <Setter Property="FontSize" Value="14" />
                                </Style>
                            </Menu.Resources>
                            <MenuItem
                                x:Name="HomeButton"
                                Click="HomeButton_Click"
                                IsEnabled="False"
                                ToolTip="Device Drives">
                                <MenuItem.Header>
                                    <ui:FontIcon FontSize="16" Glyph="&#xE80F;" />
                                </MenuItem.Header>
                            </MenuItem>
                            <MenuItem
                                x:Name="BackButton"
                                Click="BackButton_Click"
                                IsEnabled="False"
                                ToolTip="Back">
                                <MenuItem.Header>
                                    <ui:FontIcon Glyph="&#xE72B;" />
                                </MenuItem.Header>
                            </MenuItem>
                            <MenuItem
                                x:Name="ForwardButton"
                                Click="ForwardButton_Click"
                                IsEnabled="False"
                                ToolTip="Forward">
                                <MenuItem.Header>
                                    <ui:FontIcon Glyph="&#xE72A;" />
                                </MenuItem.Header>
                            </MenuItem>
                            <MenuItem
                                x:Name="ParentButton"
                                Click="ParentButton_Click"
                                IsEnabled="False"
                                ToolTip="Up">
                                <MenuItem.Header>
                                    <ui:FontIcon Glyph="&#xE197;" />
                                </MenuItem.Header>
                            </MenuItem>
                        </Menu>
                        <ui:ProgressBar
                            x:Name="DirectoryLoadingProgressBar"
                            Grid.Column="1"
                            Margin="6"
                            VerticalAlignment="Stretch"
                            Background="Transparent"
                            CornerRadius="2"
                            Foreground="#780078D7"
                            IsIndeterminate="True"
                            Visibility="Collapsed" />
                        <Grid Grid.Column="1" Margin="6">
                            <Grid.Resources>
                                <Style TargetType="TextBlock">
                                    <Setter Property="VerticalAlignment" Value="Center" />
                                </Style>
                            </Grid.Resources>
                            <TextBox
                                x:Name="PathBox"
                                VerticalAlignment="Center"
                                GotFocus="PathBox_GotFocus"
                                IsEnabled="False"
                                IsReadOnly="True"
                                KeyDown="PathBox_KeyDown"
                                LostFocus="PathBox_LostFocus"
                                Style="{StaticResource TextBoxFluentStyle}" />
                            <StackPanel
                                x:Name="PathStackPanel"
                                Margin="5,0,0,0"
                                VerticalAlignment="Center"
                                Orientation="Horizontal" />
                        </Grid>
                    </Grid>
                </StackPanel>
                <ui:ProgressBar
                    x:Name="UpperProgressBar"
                    VerticalAlignment="Bottom"
                    CornerRadius="0"
                    LargeChange="0.001"
                    Maximum="1"
                    SmallChange="0.0001"
                    Value="{Binding Progress, Mode=OneWay}">
                    <ui:ProgressBar.Style>
                        <Style TargetType="ui:ProgressBar">
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Setter Property="IsIndeterminate" Value="False" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsActive}" Value="True">
                                    <Setter Property="Visibility" Value="Visible" />
                                </DataTrigger>
                                <Trigger Property="Value" Value="0">
                                    <Setter Property="IsIndeterminate" Value="True" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </ui:ProgressBar.Style>
                </ui:ProgressBar>
            </Grid>
            <Border
                x:Name="GridBackgroundBlock"
                Grid.Row="2"
                MouseDown="GridBackgroundBlock_MouseDown"
                Style="{StaticResource ExplorerViewBackgroundStyle}">
                <Grid>
                    <ui:ItemsRepeater
                        x:Name="DrivesItemRepeater"
                        Margin="10"
                        ItemTemplate="{StaticResource DriveItemTemplate}"
                        ItemsSource="{Binding}">
                        <ui:ItemsRepeater.Layout>
                            <ui:UniformGridLayout
                                MinColumnSpacing="10"
                                MinItemHeight="60"
                                MinItemWidth="280"
                                MinRowSpacing="10" />
                        </ui:ItemsRepeater.Layout>
                    </ui:ItemsRepeater>
                    <DataGrid
                        x:Name="ExplorerGrid"
                        AutoGenerateColumns="False"
                        Background="Transparent"
                        CanUserResizeRows="False"
                        CellStyle="{StaticResource DataGridCellStyle}"
                        ContextMenu="{StaticResource RowContextMenu}"
                        ContextMenuOpening="ExplorerGrid_ContextMenuOpening"
                        GridLinesVisibility="None"
                        HeadersVisibility="Column"
                        IsReadOnly="True"
                        ItemsSource="{Binding}"
                        KeyboardNavigation.TabNavigation="Once"
                        MinRowHeight="21"
                        MouseDown="ExplorerGrid_MouseDown"
                        PreviewMouseRightButtonDown="ExplorerGrid_PreviewMouseRightButtonDown"
                        RowStyle="{StaticResource RowStyle}"
                        SelectedItem="{Binding SelectedRow, Mode=TwoWay}"
                        SelectionChanged="ExplorerGrid_SelectionChanged"
                        SelectionMode="Extended"
                        SelectionUnit="FullRow"
                        Visibility="Collapsed">
                        <DataGrid.Columns>
                            <DataGridTemplateColumn x:Name="Icon" CanUserResize="False">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Image
                                                Width="16"
                                                Margin="0,1,0,0"
                                                RenderOptions.BitmapScalingMode="HighQuality"
                                                Source="{Binding Icon}">
                                                <Image.Style>
                                                    <Style TargetType="Image">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding ExtensionIsGlyph}" Value="True">
                                                                <Setter Property="Visibility" Value="Collapsed" />
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding ExtensionIsFontIcon}" Value="True">
                                                                <Setter Property="Visibility" Value="Collapsed" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Image.Style>
                                            </Image>
                                            <TextBlock
                                                HorizontalAlignment="Center"
                                                FontSize="16"
                                                Text="{Binding ShortExtension}">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding ExtensionIsGlyph}" Value="True">
                                                                <Setter Property="FontFamily" Value="Segoe UI Symbol" />
                                                                <Setter Property="Visibility" Value="Visible" />
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding ExtensionIsFontIcon}" Value="True">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                                <Setter Property="Margin" Value="-1,-6,0,0" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Grid>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn
                                x:Name="Name"
                                Width="300"
                                Header="Name"
                                SortMemberPath="FileName">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock FontSize="{Binding Source={StaticResource FontSize}}" TextTrimming="CharacterEllipsis">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Text" Value="{Binding FileName}" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ElementName=ShowExtensionsCheckBox, Path=IsChecked}" Value="False">
                                                            <Setter Property="Text" Value="{Binding NoExtName}" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding ExtensionIsGlyph}" Value="True">
                                                            <Setter Property="FontFamily" Value="Segoe UI Symbol" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn
                                x:Name="Date"
                                Width="Auto"
                                FontSize="{Binding Source={StaticResource FontSize}}"
                                Header="Date modified"
                                SortMemberPath="ModifiedTime">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="4,0,8,0" />
                                        <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Type}" Value="File">
                                                <Setter Property="Text" Value="{Binding ModifiedTimeString}" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Type}" Value="Folder">
                                                <Setter Property="Text" Value="{Binding ModifiedTimeString}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn
                                x:Name="Type"
                                Width="150"
                                FontSize="{Binding Source={StaticResource FontSize}}"
                                Header="Type"
                                SortMemberPath="TypeName">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ExtensionIsGlyph}" Value="True">
                                                <Setter Property="FontFamily" Value="Segoe UI Symbol" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                        <Setter Property="Margin" Value="4,0,0,0" />
                                        <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                        <Setter Property="Text" Value="{Binding TypeName}" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn
                                x:Name="Size"
                                Width="Auto"
                                FontSize="{Binding Source={StaticResource FontSize}}"
                                Header="Size"
                                SortMemberPath="Size">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="4,0" />
                                        <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Type}" Value="File">
                                                <Setter Property="Text" Value="{Binding SizeString}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                    <Grid>
                        <Grid.Style>
                            <Style TargetType="Grid">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding ElementName=ExplorerGrid, Path=Items.Count}" Value="0" />
                                            <Condition Binding="{Binding ElementName=ExplorerGrid, Path=Visibility}" Value="Visible" />
                                            <Condition Binding="{Binding ElementName=MainWin, Path=ListingInProgress}" Value="False" />
                                            <Condition Binding="{Binding ElementName=PathBox, Path=IsEnabled}" Value="True" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility" Value="Visible" />
                                    </MultiDataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Grid.Style>
                        <StackPanel
                            Margin="0,40"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Top">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="This folder " />
                                <TextBlock FontStyle="Italic" Text="looks" />
                                <TextBlock Text=" empty" />
                            </StackPanel>
                            <TextBlock
                                HorizontalAlignment="Center"
                                FontSize="10"
                                Text="... to the naked eye" />
                        </StackPanel>
                    </Grid>
                </Grid>
            </Border>
            <Grid
                x:Name="FileOpDetailedGrid"
                Grid.Row="4"
                IsVisibleChanged="FileOpDetailedGrid_IsVisibleChanged">
                <Grid.Style>
                    <Style TargetType="Grid">
                        <Setter Property="Visibility" Value="Collapsed" />
                        <Style.Triggers>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding ElementName=FileOpDetailedRadioButton, Path=IsChecked}" Value="True" />
                                    <Condition Binding="{Binding ElementName=FileOperationsButton, Path=Tag}" Value="True" />
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Visibility" Value="Visible" />
                            </MultiDataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <GridSplitter
                    Height="3"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Top"
                    BorderBrush="Gray"
                    DragDelta="GridSplitter_DragDelta"
                    FocusVisualStyle="{x:Null}" />
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <ScrollViewer
                        x:Name="PendingAndCompletedDetailedScrollViewer"
                        HorizontalScrollBarVisibility="Auto"
                        PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                        <StackPanel>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <DataGrid
                                    x:Name="CurrentOperationDetailedDataGrid"
                                    Grid.Column="1"
                                    AutoGenerateColumns="False"
                                    CanUserDeleteRows="False"
                                    CellStyle="{StaticResource DataGridCellStyle}"
                                    FocusVisualStyle="{x:Null}"
                                    HeadersVisibility="Column"
                                    ItemsSource="{Binding ElementName=CurrentOperationDataGrid, Path=ItemsSource}">
                                    <DataGrid.Resources>
                                        <Style BasedOn="{StaticResource FileOpColumnHeaderStyle}" TargetType="DataGridColumnHeader" />
                                    </DataGrid.Resources>
                                    <DataGrid.Columns>
                                        <DataGridTemplateColumn
                                            Width="30"
                                            CanUserResize="False"
                                            CellTemplate="{StaticResource OperationIconTemplate}">
                                            <DataGridTemplateColumn.Header>
                                                <ui:FontIcon
                                                    Margin="-7,0"
                                                    Glyph="&#xE8AF;"
                                                    ToolTip="Operation" />
                                            </DataGridTemplateColumn.Header>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn
                                            Width="300"
                                            CellTemplate="{StaticResource FileOpFileNameTemplate}"
                                            Header="File Name" />
                                        <DataGridTemplateColumn
                                            MinWidth="100"
                                            CellTemplate="{StaticResource FileOpProgressTemplate}"
                                            Header="Progress" />
                                    </DataGrid.Columns>
                                </DataGrid>
                                <ui:FontIcon
                                    Margin="4,6"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    Glyph="&#xE9F3;"
                                    ToolTip="Current" />
                            </Grid>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <DataGrid
                                    x:Name="PendingOperationsDetailedDataGrid"
                                    Grid.Column="1"
                                    AutoGenerateColumns="False"
                                    CellStyle="{StaticResource DataGridCellStyle}"
                                    FocusVisualStyle="{x:Null}"
                                    HeadersVisibility="Column"
                                    HorizontalScrollBarVisibility="Disabled"
                                    ItemsSource="{Binding ElementName=PendingOperationsDataGrid, Path=ItemsSource}"
                                    SelectionUnit="FullRow"
                                    VerticalScrollBarVisibility="Disabled">
                                    <DataGrid.Columns>
                                        <DataGridTemplateColumn
                                            Width="30"
                                            CanUserResize="False"
                                            CellTemplate="{StaticResource OperationIconTemplate}">
                                            <DataGridTemplateColumn.Header>
                                                <ui:FontIcon
                                                    Margin="-7,0"
                                                    Glyph="&#xE8AF;"
                                                    ToolTip="Operation" />
                                            </DataGridTemplateColumn.Header>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn
                                            Width="300"
                                            CellTemplate="{StaticResource FileOpFileNameTemplate}"
                                            Header="File Name" />
                                    </DataGrid.Columns>
                                </DataGrid>
                                <ui:FontIcon
                                    Margin="4,6"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    Glyph="&#xECC5;"
                                    ToolTip="Pending" />
                            </Grid>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <DataGrid
                                    x:Name="CompletedOperationsDetailedDataGrid"
                                    Grid.Column="1"
                                    Width="Auto"
                                    AutoGenerateColumns="False"
                                    CellStyle="{StaticResource DataGridCellStyle}"
                                    FocusVisualStyle="{x:Null}"
                                    HeadersVisibility="Column"
                                    HorizontalScrollBarVisibility="Disabled"
                                    ItemsSource="{Binding ElementName=CompletedOperationsDataGrid, Path=ItemsSource}"
                                    SelectionUnit="FullRow"
                                    VerticalScrollBarVisibility="Disabled">
                                    <DataGrid.Columns>
                                        <DataGridTemplateColumn
                                            Width="30"
                                            CanUserResize="False"
                                            CellTemplate="{StaticResource OperationIconTemplate}">
                                            <DataGridTemplateColumn.Header>
                                                <ui:FontIcon
                                                    Margin="-7,0"
                                                    Glyph="&#xE8AF;"
                                                    ToolTip="Operation" />
                                            </DataGridTemplateColumn.Header>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn
                                            Width="300"
                                            CellTemplate="{StaticResource FileOpFileNameTemplate}"
                                            Header="File Name" />
                                        <DataGridTemplateColumn
                                            Width="30"
                                            CanUserResize="False"
                                            CellTemplate="{StaticResource StatusIconTemplate}">
                                            <DataGridTemplateColumn.Header>
                                                <ui:FontIcon
                                                    Margin="-7,0"
                                                    Glyph="&#xE9CE;"
                                                    ToolTip="Status" />
                                            </DataGridTemplateColumn.Header>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn
                                            Width="Auto"
                                            CellTemplate="{StaticResource FileOpStatusTemplate}"
                                            Header="Status" />
                                    </DataGrid.Columns>
                                </DataGrid>
                                <ui:FontIcon
                                    Margin="4,6"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    Glyph="&#xE930;"
                                    ToolTip="Completed" />
                            </Grid>
                        </StackPanel>
                    </ScrollViewer>
                    <Border
                        Grid.Column="1"
                        BorderBrush="Gray"
                        BorderThickness="1,0,0,0" />
                    <WrapPanel
                        Grid.Column="1"
                        Margin="1,0,0,0"
                        FlowDirection="RightToLeft"
                        Orientation="Vertical">
                        <WrapPanel.Resources>
                            <Style BasedOn="{StaticResource DisabledGlyphStyle}" TargetType="ui:FontIcon" />
                        </WrapPanel.Resources>
                        <StaticResource ResourceKey="FileOpStopMenu" />
                        <StaticResource ResourceKey="FileOpRemoveMenu" />
                        <StaticResource ResourceKey="FileOpDefaultFolderMenu" />
                    </WrapPanel>
                </Grid>
            </Grid>
            <StackPanel Grid.Row="3" Orientation="Horizontal">
                <StackPanel.Resources>
                    <Style BasedOn="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" TargetType="Separator">
                        <Setter Property="Margin" Value="8,6,4,6" />
                    </Style>
                </StackPanel.Resources>
                <StackPanel Orientation="Horizontal">
                    <StackPanel.Style>
                        <Style TargetType="StackPanel">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ElementName=ItemsCountBlock, Path=Text}" Value="0">
                                    <Setter Property="Visibility" Value="Hidden" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                    <TextBlock
                        x:Name="ItemsCountBlock"
                        Margin="8,4,0,4"
                        Text="{Binding ElementName=ExplorerGrid, Path=Items.Count}" />
                    <TextBlock Margin="0,4" Text=" item" />
                    <TextBlock Margin="0,4" Text="s">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ElementName=ItemsCountBlock, Path=Text}" Value="1">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                    <TextBlock
                        x:Name="UnfinishedBlock"
                        Margin="0,4"
                        Text=" *"
                        Visibility="Collapsed" />
                    <StackPanel Orientation="Horizontal">
                        <Separator />
                    </StackPanel>
                </StackPanel>
                <StackPanel Orientation="Horizontal">
                    <StackPanel.Style>
                        <Style TargetType="StackPanel">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ElementName=SelectedItemsBlock, Path=Text}" Value="0">
                                    <Setter Property="Visibility" Value="Hidden" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                    <TextBlock
                        x:Name="SelectedItemsBlock"
                        Margin="4,4,0,4"
                        Text="{Binding ElementName=ExplorerGrid, Path=SelectedItems.Count}" />
                    <TextBlock Margin="0,4" Text=" item" />
                    <TextBlock Margin="0,4" Text="s">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ElementName=SelectedItemsBlock, Path=Text}" Value="1">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                    <TextBlock Margin="0,4" Text=" selected" />
                    <TextBlock x:Name="TotalSizeBlock" Margin="6,4,0,4">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ElementName=TotalSizeBlock, Path=Text}" Value="0">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                    <StackPanel Orientation="Horizontal">
                        <Separator />
                    </StackPanel>
                </StackPanel>
            </StackPanel>
            <StackPanel
                Grid.Row="3"
                Margin="6,0"
                HorizontalAlignment="Right"
                VerticalAlignment="Center"
                Orientation="Horizontal">
                <ui:FontIcon
                    x:Name="UnsupportedAndroidIcon"
                    Margin="0,1,6,0"
                    Glyph="&#xE7BA;"
                    Style="{DynamicResource GlyphFont}"
                    ToolTip="Limited Support"
                    Visibility="Collapsed" />
                <TextBlock
                    x:Name="AndroidVersionBlock"
                    Margin="0,1,0,0"
                    Text="" />
            </StackPanel>
        </Grid>
        <ui:SplitView
            x:Name="FileOperationsSplitView"
            FocusVisualStyle="{x:Null}"
            OpenPaneLength="300"
            PaneClosing="FileOperationsSplitView_PaneClosing"
            PanePlacement="Right">
            <ui:SplitView.Style>
                <Style TargetType="ui:SplitView">
                    <Setter Property="IsPaneOpen" Value="False" />
                    <Style.Triggers>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding ElementName=FileOpCompactRadioButton, Path=IsChecked}" Value="True" />
                                <Condition Binding="{Binding ElementName=FileOperationsButton, Path=Tag}" Value="True" />
                            </MultiDataTrigger.Conditions>
                            <Setter Property="IsPaneOpen" Value="True" />
                        </MultiDataTrigger>
                    </Style.Triggers>
                </Style>
            </ui:SplitView.Style>
            <ui:SplitView.Pane>
                <Border BorderBrush="Gray" BorderThickness="1,1,0,0">
                    <Grid>
                        <Grid Margin="8">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="52" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontSize="24"
                                Text="File Operations" />
                            <Menu HorizontalAlignment="Right">
                                <MenuItem Click="FileOperationsButton_Click" ToolTip="Hide">
                                    <MenuItem.Header>
                                        <ui:FontIcon Glyph="&#xE761;" Style="{DynamicResource GlyphFont}" />
                                    </MenuItem.Header>
                                </MenuItem>
                            </Menu>
                            <Border
                                Grid.Row="1"
                                Margin="0,0,0,6"
                                BorderBrush="Gray"
                                BorderThickness="1">
                                <WrapPanel FlowDirection="LeftToRight" Orientation="Horizontal">
                                    <WrapPanel.Resources>
                                        <Style BasedOn="{StaticResource DisabledGlyphStyle}" TargetType="ui:FontIcon" />
                                    </WrapPanel.Resources>
                                    <StaticResource ResourceKey="FileOpStopMenu" />
                                    <StaticResource ResourceKey="FileOpRemoveMenu" />
                                    <StaticResource ResourceKey="FileOpDefaultFolderMenu" />
                                </WrapPanel>
                            </Border>
                            <Grid Grid.Row="2">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <StackPanel>
                                    <TextBlock Text="Current" />
                                    <DataGrid
                                        x:Name="CurrentOperationDataGrid"
                                        Width="Auto"
                                        MaxWidth="282"
                                        AutoGenerateColumns="False"
                                        CanUserDeleteRows="False"
                                        CellStyle="{StaticResource DataGridCellStyle}"
                                        FocusVisualStyle="{x:Null}"
                                        HeadersVisibility="None"
                                        HorizontalScrollBarVisibility="Disabled"
                                        ItemsSource="{Binding}">
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn MinWidth="100" CellTemplate="{StaticResource FileOpProgressTemplate}" />
                                            <DataGridTemplateColumn CellTemplate="{StaticResource OperationIconTemplate}" />
                                            <DataGridTemplateColumn MaxWidth="130" CellTemplate="{StaticResource FileOpFileNameTemplate}" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <StackPanel.Style>
                                        <Style TargetType="StackPanel">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=CurrentOperationDataGrid, Path=Items.Count}" Value="1">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </StackPanel.Style>
                                </StackPanel>
                                <ScrollViewer
                                    x:Name="PendingAndCompletedScrollViewer"
                                    Grid.Row="1"
                                    HorizontalScrollBarVisibility="Disabled"
                                    PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                                    <StackPanel>
                                        <StackPanel>
                                            <TextBlock Text="Pending" />
                                            <DataGrid
                                                x:Name="PendingOperationsDataGrid"
                                                Width="Auto"
                                                MaxWidth="282"
                                                AutoGenerateColumns="False"
                                                CellStyle="{StaticResource DataGridCellStyle}"
                                                FocusVisualStyle="{x:Null}"
                                                HeadersVisibility="None"
                                                HorizontalScrollBarVisibility="Disabled"
                                                ItemsSource="{Binding}"
                                                SelectionUnit="FullRow"
                                                VerticalScrollBarVisibility="Disabled">
                                                <DataGrid.Columns>
                                                    <DataGridTemplateColumn CellTemplate="{StaticResource OperationIconTemplate}" />
                                                    <DataGridTemplateColumn MaxWidth="200" CellTemplate="{StaticResource FileOpFileNameTemplate}" />
                                                </DataGrid.Columns>
                                            </DataGrid>
                                            <StackPanel.Style>
                                                <Style TargetType="StackPanel">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ElementName=PendingOperationsDataGrid, Path=Items.Count}" Value="0">
                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </StackPanel.Style>
                                        </StackPanel>
                                        <StackPanel>
                                            <TextBlock Text="Completed" />
                                            <DataGrid
                                                x:Name="CompletedOperationsDataGrid"
                                                Width="Auto"
                                                AutoGenerateColumns="False"
                                                CellStyle="{StaticResource DataGridCellStyle}"
                                                FocusVisualStyle="{x:Null}"
                                                HeadersVisibility="None"
                                                HorizontalScrollBarVisibility="Disabled"
                                                ItemsSource="{Binding}"
                                                SelectionUnit="FullRow"
                                                VerticalScrollBarVisibility="Disabled">
                                                <DataGrid.Columns>
                                                    <DataGridTemplateColumn CellTemplate="{StaticResource StatusIconTemplate}" />
                                                    <DataGridTemplateColumn CellTemplate="{StaticResource OperationIconTemplate}" />
                                                    <DataGridTemplateColumn MaxWidth="200" CellTemplate="{StaticResource FileOpFileNameTemplate}" />
                                                </DataGrid.Columns>
                                            </DataGrid>
                                            <StackPanel.Style>
                                                <Style TargetType="StackPanel">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ElementName=CompletedOperationsDataGrid, Path=Items.Count}" Value="0">
                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </StackPanel.Style>
                                        </StackPanel>
                                    </StackPanel>
                                </ScrollViewer>
                            </Grid>
                        </Grid>
                    </Grid>
                </Border>
            </ui:SplitView.Pane>
        </ui:SplitView>
        <ui:SplitView
            x:Name="DevicesSplitView"
            FocusVisualStyle="{x:Null}"
            IsPaneOpen="True"
            OpenPaneLength="200"
            PaneClosing="DevicesSplitView_PaneClosing"
            PaneOpening="DevicesSplitView_PaneOpening"
            PanePlacement="Left">
            <ui:SplitView.Pane>
                <Border
                    BorderBrush="Gray"
                    BorderThickness="0,1,1,0"
                    Style="{StaticResource DevicesListStyle}">
                    <Grid Margin="6,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="{Binding ElementName=NewDeviceRect, Path=ActualHeight}" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Menu Margin="2,4" HorizontalAlignment="Left">
                            <MenuItem x:Name="OpenNewDeviceButton" Click="OpenNewDeviceButton_Click">
                                <MenuItem.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <ui:FontIcon Margin="0,-1,6,0" FontSize="22">
                                            <ui:FontIcon.Style>
                                                <Style BasedOn="{StaticResource DisabledGlyphStyle}" TargetType="ui:FontIcon">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ElementName=NewDevicePanel, Path=Tag}" Value="Open">
                                                            <Setter Property="Glyph" Value="&#xE70E;" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                    <Setter Property="Glyph" Value="&#xE70D;" />
                                                </Style>
                                            </ui:FontIcon.Style>
                                        </ui:FontIcon>
                                        <TextBlock Grid.Column="1" Text="Pair / Connect Device">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ElementName=NewDevicePanel, Path=Tag}" Value="Open">
                                                            <Setter Property="Visibility" Value="Hidden" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                        <TextBlock Grid.Column="1" Text="Hide">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ElementName=NewDevicePanel, Path=Tag}" Value="Open">
                                                            <Setter Property="Visibility" Value="Visible" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                    <Setter Property="Visibility" Value="Hidden" />
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Grid>
                                </MenuItem.Header>
                            </MenuItem>
                        </Menu>
                        <Rectangle
                            x:Name="NewDeviceRect"
                            Grid.Row="1"
                            Height="{Binding ElementName=NewDevicePanel, Path=ActualHeight}"
                            Fill="Transparent">
                            <Rectangle.Style>
                                <Style TargetType="Rectangle">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName=NewDevicePanel, Path=Tag}" Value="Open">
                                            <DataTrigger.EnterActions>
                                                <BeginStoryboard>
                                                    <Storyboard>
                                                        <DoubleAnimation
                                                            Storyboard.TargetProperty="Height"
                                                            From="0"
                                                            Duration="0:00:00.2" />
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </DataTrigger.EnterActions>
                                            <DataTrigger.ExitActions>
                                                <BeginStoryboard>
                                                    <Storyboard>
                                                        <DoubleAnimation
                                                            Storyboard.TargetProperty="Height"
                                                            To="0"
                                                            Duration="0:00:00.2" />
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </DataTrigger.ExitActions>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Rectangle.Style>
                        </Rectangle>
                        <Border
                            Grid.Row="1"
                            Padding="8"
                            Style="{StaticResource DeviceConnectionStyle}">
                            <StackPanel
                                x:Name="NewDevicePanel"
                                VerticalAlignment="Bottom"
                                Visibility="Collapsed">
                                <Border Margin="0,9" />
                                <Grid>
                                    <Grid.Resources>
                                        <Style BasedOn="{StaticResource RadioButtonStyle}" TargetType="RadioButton" />
                                    </Grid.Resources>
                                    <Grid.Style>
                                        <Style TargetType="Grid">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=EnableMdnsCheckBox, Path=IsChecked}" Value="True">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                            <Setter Property="Visibility" Value="Collapsed" />
                                        </Style>
                                    </Grid.Style>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <TextBlock
                                        Grid.Row="1"
                                        Margin="0,0,6,0"
                                        VerticalAlignment="Center"
                                        FontWeight="Bold"
                                        Text="mDNS" />
                                    <Separator
                                        Grid.Row="1"
                                        Grid.ColumnSpan="2"
                                        Margin="10,0"
                                        VerticalAlignment="Top" />
                                    <RadioButton
                                        x:Name="ManualConnectionRadioButton"
                                        Grid.Column="1"
                                        Checked="ConnectionTypeRadioButton_Checked"
                                        Content="Manual"
                                        GroupName="ConnectionType"
                                        IsChecked="True"
                                        Unchecked="ConnectionTypeRadioButton_Checked" />
                                    <StackPanel Grid.Row="1" Grid.Column="1">
                                        <RadioButton
                                            x:Name="QrConnectionRadioButton"
                                            Checked="ConnectionTypeRadioButton_Checked"
                                            Content="QR code"
                                            GroupName="ConnectionType"
                                            Unchecked="ConnectionTypeRadioButton_Checked" />
                                        <RadioButton
                                            x:Name="PasswordConnectionRadioButton"
                                            Checked="ConnectionTypeRadioButton_Checked"
                                            Content="6 digit code"
                                            GroupName="ConnectionType"
                                            Unchecked="ConnectionTypeRadioButton_Checked" />
                                    </StackPanel>
                                </Grid>
                                <Grid>
                                    <Grid.Style>
                                        <Style TargetType="Grid">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=EnableMdnsCheckBox, Path=IsChecked}" Value="True">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                            <Setter Property="Visibility" Value="Visible" />
                                        </Style>
                                    </Grid.Style>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <ui:FontIcon Glyph="&#xE946;" />
                                    <TextBlock
                                        Grid.Column="1"
                                        Margin="6,0,0,0"
                                        FontSize="13"
                                        Text="mDNS can be enabled in the settings"
                                        TextWrapping="Wrap" />
                                </Grid>
                                <Grid x:Name="MdnsPairingGrid">
                                    <Grid.Style>
                                        <Style TargetType="Grid">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=ManualConnectionRadioButton, Path=IsChecked}" Value="False">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                            <Setter Property="Visibility" Value="Collapsed" />
                                        </Style>
                                    </Grid.Style>
                                    <StackPanel x:Name="QrPairingPanel">
                                        <StackPanel.Style>
                                            <Style TargetType="StackPanel">
                                                <Style.Triggers>
                                                    <MultiDataTrigger>
                                                        <MultiDataTrigger.Conditions>
                                                            <Condition Binding="{Binding ElementName=MainWin, Path=MdnsService.State}" Value="Running" />
                                                            <Condition Binding="{Binding ElementName=QrConnectionRadioButton, Path=IsChecked}" Value="True" />
                                                        </MultiDataTrigger.Conditions>
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </MultiDataTrigger>
                                                </Style.Triggers>
                                                <Setter Property="Visibility" Value="Collapsed" />
                                            </Style>
                                        </StackPanel.Style>
                                        <Image
                                            x:Name="PairingQrImage"
                                            Margin="0,6,0,0"
                                            RenderOptions.EdgeMode="Aliased" />
                                    </StackPanel>
                                    <StackPanel x:Name="MdnsLoadingPanel">
                                        <StackPanel.Style>
                                            <Style TargetType="StackPanel">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ElementName=MainWin, Path=MdnsService.State}" Value="Unchecked">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </StackPanel.Style>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <ui:FontIcon
                                                Margin="0,0,8,0"
                                                Glyph="&#xE946;"
                                                Style="{StaticResource GlyphFont}" />
                                            <TextBlock
                                                Grid.Column="1"
                                                Text="Checking mDNS status please wait"
                                                TextWrapping="Wrap" />
                                        </Grid>
                                    </StackPanel>
                                    <StackPanel x:Name="MdnsDownPanel">
                                        <StackPanel.Style>
                                            <Style TargetType="StackPanel">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ElementName=MainWin, Path=MdnsService.State}" Value="NotRunning">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </StackPanel.Style>
                                        <StackPanel Orientation="Horizontal">
                                            <ui:FontIcon
                                                Margin="0,0,8,0"
                                                Glyph="&#xE783;"
                                                Style="{StaticResource GlyphFont}" />
                                            <TextBlock x:Name="MdnsDownBlock" Text="mDNS server is down" />
                                        </StackPanel>
                                        <Button
                                            x:Name="RestartAdbButton"
                                            Margin="0,6,0,0"
                                            HorizontalAlignment="Center"
                                            Click="RestartAdbButton_Click"
                                            Content="Restart ADB"
                                            Style="{StaticResource ButtonStyle}" />
                                    </StackPanel>
                                </Grid>
                                <StackPanel x:Name="ManualDeviceConnectPanel">
                                    <StackPanel.Style>
                                        <Style TargetType="StackPanel">
                                            <Setter Property="Visibility" Value="Visible" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=ManualConnectionRadioButton, Path=IsChecked}" Value="False">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding ElementName=ManualPairingPanel, Path=IsEnabled}" Value="True">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </StackPanel.Style>
                                    <TextBox
                                        x:Name="NewDeviceIpBox"
                                        Margin="0,6,0,12"
                                        ui:ControlHelper.PlaceholderText="IP Address"
                                        KeyDown="NewDeviceIpBox_KeyDown"
                                        Style="{StaticResource NumericTextBoxStyle}"
                                        TextChanged="NewDeviceIpBox_TextChanged" />
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <TextBox
                                            x:Name="NewDevicePortBox"
                                            VerticalContentAlignment="Center"
                                            ui:ControlHelper.PlaceholderText="Port"
                                            KeyDown="NewDeviceIpBox_KeyDown"
                                            Style="{StaticResource NumericTextBoxStyle}"
                                            TextChanged="NewDevicePortBox_TextChanged" />
                                        <Button
                                            x:Name="ConnectNewDeviceButton"
                                            Grid.Column="1"
                                            Margin="8,0,0,0"
                                            Click="ConnectNewDeviceButton_Click"
                                            Content="Connect"
                                            IsEnabled="False"
                                            Style="{StaticResource ButtonStyle}" />
                                    </Grid>
                                </StackPanel>
                                <StackPanel x:Name="ManualPairingPanel" IsEnabled="False">
                                    <StackPanel.Style>
                                        <Style TargetType="StackPanel">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <Trigger Property="IsEnabled" Value="True">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </StackPanel.Style>
                                    <Grid Margin="0,6,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <ui:FontIcon
                                            Margin="0,0,8,0"
                                            Glyph="&#xE783;"
                                            Style="{StaticResource GlyphFont}" />
                                        <TextBlock
                                            Grid.Column="1"
                                            Text="Unable to connect. Try pairing"
                                            TextWrapping="Wrap" />
                                        <Button
                                            x:Name="CancelManualPairing"
                                            Grid.Column="2"
                                            Margin="4"
                                            Click="CancelManualPairing_Click"
                                            Style="{StaticResource ButtonStyle}"
                                            ToolTip="Cancel">
                                            <ui:FontIcon
                                                FontSize="10"
                                                Glyph="&#xE8BB;"
                                                Style="{StaticResource DisabledButtonGlyphStyle}" />
                                        </Button>
                                    </Grid>
                                    <Grid Margin="0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <TextBox
                                            x:Name="ManualPairingPortBox"
                                            VerticalContentAlignment="Center"
                                            ui:ControlHelper.PlaceholderText="Pairing Port"
                                            KeyDown="NewDeviceIpBox_KeyDown"
                                            Style="{StaticResource NumericTextBoxStyle}"
                                            TextChanged="ManualPairingPortBox_TextChanged" />
                                        <Button
                                            x:Name="PairNewDeviceButton"
                                            Grid.Column="1"
                                            Margin="8,0,0,0"
                                            HorizontalAlignment="Right"
                                            Click="PairNewDeviceButton_Click"
                                            Content="Pair"
                                            IsEnabled="False"
                                            Style="{StaticResource ButtonStyle}" />
                                    </Grid>
                                    <TextBox
                                        x:Name="ManualPairingCodeBox"
                                        ui:ControlHelper.PlaceholderText="Pairing Code"
                                        Style="{StaticResource PairingTextBoxStyle}"
                                        TextChanged="PairingCodeBox_TextChanged" />
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        <Grid Grid.Row="2" Margin="0,6">
                            <ui:ProgressRing
                                Margin="6,4,0,0"
                                HorizontalAlignment="Left"
                                IsActive="True" />
                            <TextBlock
                                HorizontalAlignment="Center"
                                FontSize="24"
                                Text="Devices" />
                        </Grid>
                        <ui:ListView
                            x:Name="DevicesList"
                            Grid.Row="3"
                            DataContext="{Binding ElementName=MainWin, Path=DevicesObject}"
                            IsSelectionEnabled="False"
                            ItemContainerStyle="{StaticResource DeviceStyle}"
                            ItemsSource="{Binding UIList}"
                            MouseDown="DevicesList_MouseDown" />
                    </Grid>
                </Border>
            </ui:SplitView.Pane>
        </ui:SplitView>
        <ui:SplitView
            x:Name="SettingsSplitView"
            FocusVisualStyle="{x:Null}"
            OpenPaneLength="350"
            PanePlacement="Right">
            <ui:SplitView.Resources>
                <Style TargetType="Separator">
                    <Setter Property="Width" Value="300" />
                    <Setter Property="Margin" Value="0,0,20,6" />
                    <Setter Property="HorizontalAlignment" Value="Center" />
                </Style>
            </ui:SplitView.Resources>
            <ui:SplitView.Pane>
                <Border BorderBrush="Gray" BorderThickness="1,1,0,0">
                    <Grid Margin="18,8,24,8">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="48" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Menu Margin="0,0,-18,0" HorizontalAlignment="Right">
                            <MenuItem Click="PaneCollapse_Click" ToolTip="Hide">
                                <MenuItem.Header>
                                    <ui:FontIcon Glyph="&#xE761;" Style="{DynamicResource GlyphFont}" />
                                </MenuItem.Header>
                            </MenuItem>
                        </Menu>
                        <TextBlock
                            HorizontalAlignment="Center"
                            FontSize="24"
                            Text="Settings" />
                        <ScrollViewer Grid.Row="1" PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                            <StackPanel Margin="6,0,0,0" HorizontalAlignment="Left">
                                <StackPanel.Resources>
                                    <Style BasedOn="{StaticResource CheckBoxStyle}" TargetType="CheckBox" />
                                    <Style BasedOn="{StaticResource RadioButtonStyle}" TargetType="RadioButton" />
                                </StackPanel.Resources>
                                <TextBlock Text="Theme" />
                                <StackPanel Margin="0,6,0,15">
                                    <RadioButton
                                        x:Name="LightThemeRadioButton"
                                        Checked="LightThemeRadioButton_Checked"
                                        Content="Light" />
                                    <RadioButton
                                        x:Name="DarkThemeRadioButton"
                                        Checked="DarkThemeRadioButton_Checked"
                                        Content="Dark" />
                                </StackPanel>
                                <Separator />
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock VerticalAlignment="Center" Text="Default Folder" />
                                    <Button
                                        x:Name="ChangeDefaultFolderButton"
                                        Grid.Column="1"
                                        Click="ChangeDefaultFolderButton_Click"
                                        Style="{StaticResource ButtonStyle}"
                                        ToolTip="Change">
                                        <ui:FontIcon
                                            FontSize="16"
                                            Glyph="&#xE70F;"
                                            Style="{StaticResource DisabledButtonGlyphStyle}" />
                                    </Button>
                                </Grid>
                                <TextBlock
                                    x:Name="DefaultFolderBlock"
                                    Margin="0,6,0,15"
                                    FontFamily="Consolas"
                                    Text="[not set]" />
                                <Separator />
                                <TextBlock Text="File Double-Click Behavior" />
                                <StackPanel Margin="0,6,0,15">
                                    <CheckBox
                                        x:Name="PullOnDoubleClickCheckBox"
                                        Checked="PullOnDoubleClickCheckBox_Checked"
                                        Content="Pull To Default Folder" />
                                </StackPanel>
                                <Separator />
                                <TextBlock Text="Connection" />
                                <StackPanel Margin="0,6,0,15">
                                    <CheckBox
                                        x:Name="EnableMdnsCheckBox"
                                        Checked="EnableMdnsCheckBox_Checked"
                                        Content="Enable mDNS (experimental)"
                                        Unchecked="EnableMdnsCheckBox_Checked" />
                                    <CheckBox
                                        x:Name="RememberIpCheckBox"
                                        Click="RememberIpCheckBox_Click"
                                        Content="Remember Last IP" />
                                    <CheckBox
                                        x:Name="RememberPortCheckBox"
                                        Click="RememberPortCheckBox_Click"
                                        Content="Remember Last Port" />
                                    <CheckBox
                                        x:Name="AutoOpenCheckBox"
                                        Click="AutoOpenCheckBox_Click"
                                        Content="Automatically Open for Browsing" />
                                </StackPanel>
                                <Separator />
                                <TextBlock Text="File Operations" Visibility="Collapsed" />
                                <StackPanel Margin="0,6,0,15" Visibility="Collapsed">
                                    <TreeView x:Name="FileOpSettingsTree" ItemTemplate="{StaticResource FileOpSettingsTreeTemplate}" />
                                </StackPanel>
                                <TextBlock Text="Show" />
                                <StackPanel Margin="0,6,0,15">
                                    <CheckBox
                                        x:Name="ShowExtensionsCheckBox"
                                        Click="ShowExtensionsCheckBox_Click"
                                        Content="File Name Extensions"
                                        IsChecked="True" />
                                    <CheckBox
                                        x:Name="ShowHiddenCheckBox"
                                        Click="ShowHiddenCheckBox_Click"
                                        Content="Hidden Items"
                                        IsChecked="True" />
                                </StackPanel>
                                <Separator />
                                <TextBlock Text="File Operations" />
                                <StackPanel Margin="0,6,0,15">
                                    <RadioButton
                                        x:Name="FileOpCompactRadioButton"
                                        Checked="FileOpCompactRadioButton_Checked"
                                        Content="Compact" />
                                    <RadioButton
                                        x:Name="FileOpDetailedRadioButton"
                                        Checked="FileOpDetailedRadioButton_Checked"
                                        Content="Detailed" />
                                </StackPanel>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                </Border>
            </ui:SplitView.Pane>
        </ui:SplitView>
    </Grid>
</Window>
